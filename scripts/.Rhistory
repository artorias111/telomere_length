load('../processed_data/cb_len_isotype.Rdata')
load('../processed_data/brig_pop_boxplot.Rdata')
load('../processed_data/cbrqx3794_model.Rdata')
cbraex5 <- brig_geno %>% dplyr::filter(POS>4658249 & POS<4661255) %>% dplyr::filter(CHROM=="IV")
#cbraex5 <- brig_fgeno %>% filter(POS==14804441 | POS==14798602 | POS==14800045) %>% filter(CHROM==1)
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
brig_temp <- brig_temp1 %>% inner_join(cb_len_isotype) %>% filter(altref==1) %>% dplyr::select(POS,length,isotype)
cbraex5_plot <- brig_temp %>% ggplot(aes(x=POS,y=length,group=POS)) +
geom_boxplot(width=45) +
theme_bw() +
#scale_x_continuous(breaks=c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),lim=c(14669282,14679748))+
scale_x_continuous(lim=c(4658249,4661255))+
#geom_jitter(color="black", alpha=0.1) +
#theme(axis.title = element_blank(), legend.position = "none",axis.text.x = element_text(angle = 60, vjust = 1, hjust = 1))+
theme(axis.title = element_blank(), legend.position = "none")+
ylim(0,15)
#geom_hline(yintercept=3.68,color='blue')
#geom_vline(xintercept = c(14669282,14679748,14669282,14671667,14676069,14676749,14677416,14677725,14679067,14679211,14670011,14671846,14676265,14676905,14677619,14677823,14679164,14679748),linetype="dashed",alpha=0.5)
#geom_vline(xintercept = c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),linetype="dashed",alpha=0.5)
cbraex5_plot
p <- plot_grid(cbrqx3794_model,cbraex5_plot,ncol=1, align='v',rel_widths=c(1,1),rel_heights = c(1,12))
x <- plot_grid(NULL,brig_pop_plot,ncol=1,align='v',rel_widths=c(1,1),rel_heights = c(1,12))
#ggsave("../plots/cbraex5_boxplot.png",dpi=300,height=4,width = 8, units = "in")
#ggsave("../plots/cbraex5_boxplot_high_impact.png",dpi=300,height=4,width = 8, units = "in")
q <- plot_grid(p,x,rel_widths = c(3,1))
q
ggsave("../plots/cbrqx3794_boxplot.png",dpi=300,height=4,width = 12, units = "in")
#manhattan plots
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#load brig geno
load('../processed_data/brig_geno.Rdata')
load('../processed_data/brig_fgeno.Rdata')
load('../processed_data/cb_len_isotype.Rdata')
load('../processed_data/brig_pop_boxplot.Rdata')
load('../processed_data/cbrqx3794_model.Rdata')
cbraex5 <- brig_geno %>% dplyr::filter(POS>4658249 & POS<4661255) %>% dplyr::filter(CHROM=="IV")
#cbraex5 <- brig_fgeno %>% filter(POS==14804441 | POS==14798602 | POS==14800045) %>% filter(CHROM==1)
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
brig_temp <- brig_temp1 %>% inner_join(cb_len_isotype) %>% filter(altref==1) %>% dplyr::select(POS,length,isotype)
cbraex5_plot <- brig_temp %>% ggplot(aes(x=POS,y=length,group=POS)) +
geom_boxplot(width=45) +
theme_bw() +
#scale_x_continuous(breaks=c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),lim=c(14669282,14679748))+
scale_x_continuous(lim=c(4658249,4661255))+
#geom_jitter(color="black", alpha=0.1) +
#theme(axis.title = element_blank(), legend.position = "none",axis.text.x = element_text(angle = 60, vjust = 1, hjust = 1))+
theme(axis.title = element_blank(), legend.position = "none")+
ylim(0,15)
#geom_hline(yintercept=3.68,color='blue')
#geom_vline(xintercept = c(14669282,14679748,14669282,14671667,14676069,14676749,14677416,14677725,14679067,14679211,14670011,14671846,14676265,14676905,14677619,14677823,14679164,14679748),linetype="dashed",alpha=0.5)
#geom_vline(xintercept = c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),linetype="dashed",alpha=0.5)
cbraex5_plot
p <- plot_grid(cbrqx3794_model,cbraex5_plot,ncol=1, align='v',rel_widths=c(1,1),rel_heights = c(1,12))
x <- plot_grid(NULL,brig_pop_plot,ncol=1,align='v',rel_widths=c(1,1),rel_heights = c(1,12))
#ggsave("../plots/cbraex5_boxplot.png",dpi=300,height=4,width = 8, units = "in")
#ggsave("../plots/cbraex5_boxplot_high_impact.png",dpi=300,height=4,width = 8, units = "in")
q <- plot_grid(p,x,rel_widths = c(3,1))
q
ggsave("../plots/cbrqx3794_boxplot.png",dpi=300,height=4,width = 12, units = "in")
#orthofinder - cbrmrt1.2
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#
load("../functions/gene_model.Rdata")
load("../processed_data/goi_list.Rdata")
goi_list <- goi_list %>% add_row(
gene='qx3794',
chr='IV',
strand='+',
txstart=4658249,
txend=4661255,
codingstart=txstart,
codingend=txend,
numexons=4,
wbgene='Wb000',
gene_name=gene,
biotype='protein_coding',
exonstarts='4658249,4658950,4659392,4660273',
exonends='4658454,4659147,4659532,4661255',
type='transcript'
)
cbr_model <- gene_model(goi_list,'qx3794')
cbr_model
save(cbr_model,file="../processed_data/cbrqx3794_model.Rdata")
#manhattan plots
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#load brig geno
load('../processed_data/brig_geno.Rdata')
load('../processed_data/brig_fgeno.Rdata')
load('../processed_data/cb_len_isotype.Rdata')
load('../processed_data/brig_pop_boxplot.Rdata')
load('../processed_data/cbrqx3794_model.Rdata')
cbraex5 <- brig_geno %>% dplyr::filter(POS>4658249 & POS<4661255) %>% dplyr::filter(CHROM=="IV")
#cbraex5 <- brig_fgeno %>% filter(POS==14804441 | POS==14798602 | POS==14800045) %>% filter(CHROM==1)
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
brig_temp <- brig_temp1 %>% inner_join(cb_len_isotype) %>% filter(altref==1) %>% dplyr::select(POS,length,isotype)
cbraex5_plot <- brig_temp %>% ggplot(aes(x=POS,y=length,group=POS)) +
geom_boxplot(width=45) +
theme_bw() +
#scale_x_continuous(breaks=c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),lim=c(14669282,14679748))+
scale_x_continuous(lim=c(4658249,4661255))+
#geom_jitter(color="black", alpha=0.1) +
#theme(axis.title = element_blank(), legend.position = "none",axis.text.x = element_text(angle = 60, vjust = 1, hjust = 1))+
theme(axis.title = element_blank(), legend.position = "none")+
ylim(0,15)
#geom_hline(yintercept=3.68,color='blue')
#geom_vline(xintercept = c(14669282,14679748,14669282,14671667,14676069,14676749,14677416,14677725,14679067,14679211,14670011,14671846,14676265,14676905,14677619,14677823,14679164,14679748),linetype="dashed",alpha=0.5)
#geom_vline(xintercept = c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),linetype="dashed",alpha=0.5)
cbraex5_plot
p <- plot_grid(cbr_model,cbraex5_plot,ncol=1, align='v',rel_widths=c(1,1),rel_heights = c(1,12))
x <- plot_grid(NULL,brig_pop_plot,ncol=1,align='v',rel_widths=c(1,1),rel_heights = c(1,12))
#ggsave("../plots/cbraex5_boxplot.png",dpi=300,height=4,width = 8, units = "in")
#ggsave("../plots/cbraex5_boxplot_high_impact.png",dpi=300,height=4,width = 8, units = "in")
q <- plot_grid(p,x,rel_widths = c(3,1))
q
ggsave("../plots/cbrqx3794_boxplot.png",dpi=300,height=4,width = 12, units = "in")
#elegans brood size correlation
library('tidyverse')
library('ggscatter')
broodsize <- read_csv("../data/elegans/correlation_data/brood_size.csv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
bs_merged <- inner_join(broodsize,eleg_strains)
bs_plot <- bs_merged %>% ggplot(aes(x=mean_b,y=length))+
geom_point()+
theme_bw()+
xlab("mean brood size")+
ylab("telomere length")+
geom_smooth(method="auto")
theme(text = element_text(size=7))
bs_plot
ggsave("../plots2/cel_broodsize_correlation.png",dpi=300,height=4,width = 4, units = "in")
#elegans brood size correlation
library('tidyverse')
library('ggscatter')
broodsize <- read_csv("../data/elegans/correlation_data/brood_size.csv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
bs_merged <- inner_join(broodsize,eleg_strains)
bs_plot <- bs_merged %>% ggplot(aes(x=mean_b,y=length))+
geom_point()+
theme_bw()+
xlab("mean brood size")+
ylab("telomere length")+
geom_smooth(method="lm")
theme(text = element_text(size=7))
bs_plot
ggsave("../plots2/cel_broodsize_correlation.png",dpi=300,height=4,width = 4, units = "in")
view(bs_merged)
correlated <- cor(bs_merged$length,bs_merged$mean_b,method="spearman")
correlated
#elegans brood size correlation
library('tidyverse')
library('ggscatter')
broodsize <- read_csv("../data/elegans/correlation_data/brood_size.csv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
bs_merged <- inner_join(broodsize,eleg_strains)
bs_corr <- cor(bs_merged$length,bs_merged$mean_b,method="spearman")
bs_plot <- bs_merged %>% ggplot(aes(x=mean_b,y=length))+
geom_point()+
theme_bw()+
xlab("mean brood size")+
ylab("telomere length")+
geom_smooth(method="lm")
theme(text = element_text(size=7))
bs_plot
ggsave("../plots2/cel_broodsize_correlation.png",dpi=300,height=4,width = 4, units = "in")
#elegans lifespan correlation
library('tidyverse')
healthspan <- read_tsv("../data/elegans/correlation_data/pr_t89_mean.tsv")
lifespan <- read_tsv("../data/elegans/correlation_data/pr_t97_mean.tsv")
lifespan2 <- read_tsv("../data/elegans/correlation_data/life_machine_trait_file.tsv")
raw_data <- read_tsv("../data/elegans/correlation_data/healthspan_lifespan_raw.tsv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
merged <- inner_join(raw_data,eleg_strains)
ls2_plot <- merged %>% ggplot(aes(x=t89_mean,y=length))+
geom_point()+
theme_bw()+
theme(text = element_text(size=7)) +
geom_smooth(method="lm")
xlab("healthspan")+
ylab("telomere length")
ls2_plot
ggsave("../plots2/cel_healthspan_raw.png",dpi=300,height=4,width = 4, units = "in")
# ls_merged <- inner_join(lifespan,eleg_strains)
# ls_plot <- ls_merged %>% ggplot(aes(x=t97_mean,y=length))+
#   geom_point()+
#   theme_bw()+
#   theme(text = element_text(size=7)) +
#   xlab("lifespan")+
#   ylab("telomere length")
# ls_plot
# ggsave("../plots2/cel_lifespan1_correlation.png",dpi=300,height=4,width = 4, units = "in")
# hs_merged <- inner_join(healthspan,eleg_strains)
# hs_plot <- hs_merged %>% ggplot(aes(x=t89_mean,y=length))+
#   geom_point()+
#   theme_bw()+
#   theme(text = element_text(size=7)) +
#   xlab("healthspan")+
#   ylab("telomere length")
# hs_plot
# ggsave("../plots2/cel_healthspan_correlation1.png",dpi=300,height=4,width = 4, units = "in")
#
#
# ls2_merged <- inner_join(lifespan2,eleg_strains)
# ls2_plot <- ls2_merged %>% ggplot(aes(x=mean_ls,y=length)) +
#   geom_point()+
#   theme_bw()+
#   theme(text = element_text(size=7)) +
#   xlab("lifespan")+
#   ylab("telomere length")
# ls2_plot
# ggsave("../plots2/cel_lifespan_correlation2.png",dpi=300,height=4,width = 4, units = "in")
#
hs_merged <- inner_join(healthspan,eleg_strains)
hs_plot <- hs_merged %>% ggplot(aes(x=t89_mean,y=length))+
geom_point()+
theme_bw()+
theme(text = element_text(size=7)) +
geom_smooth(method="lm")
xlab("healthspan")+
ylab("telomere length")
hs_plot
ggsave("../plots2/cel_healthspan_correlation1.png",dpi=300,height=4,width = 4, units = "in")
ls2_merged <- inner_join(lifespan2,eleg_strains)
ls2_plot <- ls2_merged %>% ggplot(aes(x=mean_ls,y=length)) +
geom_point()+
theme_bw()+
theme(text = element_text(size=7)) +
xlab("lifespan")+
ylab("telomere length")
ls2_plot
ggsave("../plots2/cel_lifespan_correlation2.png",dpi=300,height=4,width = 4, units = "in")
ls2_merged <- inner_join(lifespan2,eleg_strains)
ls2_plot <- ls2_merged %>% ggplot(aes(x=mean_ls,y=length)) +
geom_point()+
theme_bw()+
theme(text = element_text(size=7)) +
xlab("lifespan")+
geom_smooth(method="lm")+
ylab("telomere length")
ls2_plot
ggsave("../plots2/cel_lifespan_correlation2.png",dpi=300,height=4,width = 4, units = "in")
ls2_merged <- inner_join(lifespan2,eleg_strains)
ls2_plot <- ls2_merged %>% ggplot(aes(x=mean_ls,y=length)) +
geom_point()+
theme_bw()+
theme(text = element_text(size=7)) +
xlab("lifespan")+
geom_smooth(method="lm")+
ylab("telomere length")
ls2_plot
ggsave("../plots/cel_lifespan_correlation2.png",dpi=300,height=4,width = 4, units = "in")
hs_merged <- inner_join(healthspan,eleg_strains)
hs_plot <- hs_merged %>% ggplot(aes(x=t89_mean,y=length))+
geom_point()+
theme_bw()+
theme(text = element_text(size=7)) +
geom_smooth(method="lm")
xlab("healthspan")+
ylab("telomere length")
hs_plot
ggsave("../plots/cel_healthspan_correlation1.png",dpi=300,height=4,width = 4, units = "in")
hs_merged <- inner_join(healthspan,eleg_strains)
hs_plot <- hs_merged %>% ggplot(aes(x=t89_mean,y=length))+
geom_point()+
theme_bw()+
theme(text = element_text(size=7)) +
geom_smooth(method="lm")+
xlab("healthspan")+
ylab("telomere length")
hs_plot
ggsave("../plots/cel_healthspan_correlation1.png",dpi=300,height=4,width = 4, units = "in")
bs_plot + stat_cor(method="pearson")
#elegans brood size correlation
library('tidyverse')
library('ggscatter')
broodsize <- read_csv("../data/elegans/correlation_data/brood_size.csv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
bs_merged <- inner_join(broodsize,eleg_strains)
bs_corr <- cor(bs_merged$length,bs_merged$mean_b,method="spearman")
bs_plot <- bs_merged %>% ggplot(aes(x=mean_b,y=length))+
geom_point()+
theme_bw()+
xlab("mean brood size")+
ylab("telomere length")+
geom_smooth(method="lm")
theme(text = element_text(size=7))
bs_plot + stat_cor(method="pearson")
#ggsave("../plots2/cel_broodsize_correlation.png",dpi=300,height=4,width = 4, units = "in")
library('stat_cor')
library.install('ggpubr')
install.packages("ggpubr")
install.packages("ggpubr")
install.packages("ggpubr")
install.packages("ggpubr")
install.packages("ggpubr")
install.packages("ggpubr")
#elegans brood size correlation
library('tidyverse')
library('ggscatter')
library('ggpubr')
broodsize <- read_csv("../data/elegans/correlation_data/brood_size.csv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
bs_merged <- inner_join(broodsize,eleg_strains)
bs_corr <- cor(bs_merged$length,bs_merged$mean_b,method="spearman")
bs_plot <- bs_merged %>% ggplot(aes(x=mean_b,y=length))+
geom_point()+
theme_bw()+
xlab("mean brood size")+
ylab("telomere length")+
geom_smooth(method="lm")
theme(text = element_text(size=7))
bs_plot + stat_cor(method="pearson")
#ggsave("../plots2/cel_broodsize_correlation.png",dpi=300,height=4,width = 4, units = "in")
#elegans brood size correlation
library('tidyverse')
library('ggscatter')
library('ggpubr')
broodsize <- read_csv("../data/elegans/correlation_data/brood_size.csv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
bs_merged <- inner_join(broodsize,eleg_strains)
bs_corr <- cor(bs_merged$length,bs_merged$mean_b,method="spearman")
bs_plot <- bs_merged %>% ggplot(aes(x=mean_b,y=length))+
geom_point()+
theme_bw()+
xlab("mean brood size")+
ylab("telomere length")+
geom_smooth(method="lm")
theme(text = element_text(size=7))
bs_plot + stat_cor(method="pearson")
ggsave("../plots2/cel_broodsize_correlation.png",dpi=300,height=4,width = 4, units = "in")
# ls_merged <- inner_join(lifespan,eleg_strains)
# ls_plot <- ls_merged %>% ggplot(aes(x=t97_mean,y=length))+
#   geom_point()+
#   theme_bw()+
#   theme(text = element_text(size=7)) +
#   xlab("lifespan")+
#   ylab("telomere length")
# ls_plot
# ggsave("../plots2/cel_lifespan1_correlation.png",dpi=300,height=4,width = 4, units = "in")
#elegans lifespan correlation
library('tidyverse')
library('ggscatter')
library('ggpubr')
healthspan <- read_tsv("../data/elegans/correlation_data/pr_t89_mean.tsv")
lifespan <- read_tsv("../data/elegans/correlation_data/pr_t97_mean.tsv")
lifespan2 <- read_tsv("../data/elegans/correlation_data/life_machine_trait_file.tsv")
raw_data <- read_tsv("../data/elegans/correlation_data/healthspan_lifespan_raw.tsv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
merged <- inner_join(raw_data,eleg_strains)
ls2_plot <- merged %>% ggplot(aes(x=t89_mean,y=length))+
geom_point()+
theme_bw()+
theme(text = element_text(size=7)) +
geom_smooth(method="lm")
xlab("healthspan")+
ylab("telomere length")
ls2_plot + stat_cor(method="pearson")
ggsave("../plots/cel_healthspan_raw.png",dpi=300,height=4,width = 4, units = "in")
ls_merged <- inner_join(lifespan,eleg_strains)
ls_plot <- ls_merged %>% ggplot(aes(x=t97_mean,y=length))+
geom_point()+
theme_bw()+
theme(text = element_text(size=7)) +
xlab("lifespan")+
ylab("telomere length")
ls_plot + stat_cor(method="pearson")
ggsave("../plots/cel_lifespan1_correlation.png",dpi=300,height=4,width = 4, units = "in")
hs_merged <- inner_join(healthspan,eleg_strains)
hs_plot <- hs_merged %>% ggplot(aes(x=t89_mean,y=length))+
geom_point()+
theme_bw()+
theme(text = element_text(size=7)) +
geom_smooth(method="lm")+
xlab("healthspan")+
ylab("telomere length")
hs_plot+ stat_cor(method="pearson")
ggsave("../plots/cel_healthspan_correlation1.png",dpi=300,height=4,width = 4, units = "in")
#
#
ls2_merged <- inner_join(lifespan2,eleg_strains)
ls2_plot <- ls2_merged %>% ggplot(aes(x=mean_ls,y=length)) +
geom_point()+
theme_bw()+
theme(text = element_text(size=7)) +
xlab("lifespan")+
geom_smooth(method="lm")+
ylab("telomere length")
ls2_plot+ stat_cor(method="pearson")
ggsave("../plots/cel_lifespan_correlation2.png",dpi=300,height=4,width = 4, units = "in")
#elegans brood size correlation
library('tidyverse')
library('ggscatter')
library('ggpubr')
broodsize <- read_csv("../data/elegans/correlation_data/brood_size.csv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
bs_merged <- inner_join(broodsize,eleg_strains)
bs_corr <- cor(bs_merged$length,bs_merged$mean_b,method="spearman")
bs_plot <- bs_merged %>% ggplot(aes(x=mean_b,y=length))+
geom_point()+
theme_bw()+
xlab("mean brood size")+
ylab("telomere length")+
geom_smooth(method="lm")
theme(text = element_text(size=7))
bs_plot + stat_cor(method="pearson")
ggsave("../plots2/cel_broodsize_correlation.png",dpi=300,height=4,width = 4, units = "in")
#elegans brood size correlation
library('tidyverse')
library('ggscatter')
library('ggpubr')
broodsize <- read_csv("../data/elegans/correlation_data/brood_size.csv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
bs_merged <- inner_join(broodsize,eleg_strains)
bs_corr <- cor(bs_merged$length,bs_merged$mean_b,method="spearman")
bs_plot <- bs_merged %>% ggplot(aes(x=mean_b,y=length))+
geom_point()+
theme_bw()+
xlab("mean brood size")+
ylab("telomere length")+
geom_smooth(method="lm")
theme(text = element_text(size=7))
bs_plot + stat_cor(method="pearson")
ggsave("../plots/cel_broodsize_correlation.png",dpi=300,height=4,width = 4, units = "in")
#elegans brood size correlation
library('tidyverse')
library('ggscatter')
library('ggpubr')
broodsize <- read_csv("../data/elegans/correlation_data/brood_size.csv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
bs_merged <- inner_join(broodsize,eleg_strains)
bs_corr <- cor(bs_merged$length,bs_merged$mean_b,method="spearman")
bs_plot <- bs_merged %>% ggplot(aes(x=mean_b,y=length))+
geom_point()+
theme_bw()+
xlab("mean brood size")+
ylab("telomere length")+
geom_smooth(method="lm")+
geom_abline(slope=1, intercept = 0)+
theme(text = element_text(size=7))
bs_plot + stat_cor(method="pearson")
#ggsave("../plots/cel_broodsize_correlation.png",dpi=300,height=4,width = 4, units = "in")
#elegans brood size correlation
library('tidyverse')
library('ggscatter')
library('ggpubr')
broodsize <- read_csv("../data/elegans/correlation_data/brood_size.csv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
bs_merged <- inner_join(broodsize,eleg_strains)
bs_corr <- cor(bs_merged$length,bs_merged$mean_b,method="spearman")
bs_plot <- bs_merged %>% ggplot(aes(x=mean_b,y=length))+
geom_point()+
theme_bw()+
xlab("mean brood size")+
ylab("telomere length")+
geom_smooth(method="lm")+
geom_abline(slope=1, intercept = 0)+
theme(text = element_text(size=7))
bs_plot + stat_cor(method="pearson")
#ggsave("../plots/cel_broodsize_correlation.png",dpi=300,height=4,width = 4, units = "in")
#elegans brood size correlation
library('tidyverse')
library('ggscatter')
library('ggpubr')
broodsize <- read_csv("../data/elegans/correlation_data/brood_size.csv")
eleg_strains <- read_tsv("../data/elegans/lengths/eleg_strain.tsv")
bs_merged <- inner_join(broodsize,eleg_strains)
bs_corr <- cor(bs_merged$length,bs_merged$mean_b,method="spearman")
bs_plot <- bs_merged %>% ggplot(aes(x=mean_b,y=length))+
geom_point()+
theme_bw()+
xlab("mean brood size")+
ylab("telomere length")+
geom_smooth(method="lm")+
geom_abline(slope=1, intercept = 0)+
theme(text = element_text(size=7))
bs_plot + stat_cor(method="pearson")
#ggsave("../plots/cel_broodsize_correlation.png",dpi=300,height=4,width = 4, units = "in")
