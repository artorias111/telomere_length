ctrop_bar <- k %>% mutate(isotype=fct_reorder(isotype,length)) %>%
ggplot(aes(x=isotype,y=length,fill=as.factor(status))) +
labs(fill="isotype") +
geom_bar(stat='identity') +
theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +
xlab(expression(paste(italic('C. tropicalis')," isotypes")))+
ggtitle("IV:4633871")
ctrop_bar
ggsave("../plots/ctrop9944_barplot1.png",dpi=300,height=4,width = 8, units = "in")
ggsave("../plots/ctrop9944_barplot3.png",dpi=300,height=4,width = 8, units = "in")
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#load brig geno
load('../processed_data/trop_geno.Rdata')
load('../processed_data/ct_len_isotype.Rdata')
#variants in notion
#variants : 4633871,4633917,4634192
ctrop <- trop_geno %>% filter(POS==4634192) %>% filter(CHROM=="IV")
trop_temp1 <- ctrop %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
iso_list <- trop_temp1 %>% filter(altref==-1) %>% dplyr::select(isotype) %>% distinct() %>% add_column(status=1)
ctrop_strains <- ct_len_isotype %>% mutate(isotype=fct_reorder(isotype,length))
x <- as_tibble(setdiff(ctrop_strains$isotype,iso_list$isotype))
y <- x %>% add_column(status=-1)
y <- y %>% dplyr::rename(isotype=value)
z <- full_join(iso_list,y)
k <- inner_join(ct_len_isotype,z)
k <- k %>% mutate(status=as.character(status)) %>% mutate(status=str_replace(status,"-1","alt")) %>% mutate(status=str_replace(status,"1","ref"))
ctrop_bar <- k %>% mutate(isotype=fct_reorder(isotype,length)) %>%
ggplot(aes(x=isotype,y=length,fill=as.factor(status))) +
labs(fill="isotype") +
geom_bar(stat='identity') +
theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +
xlab(expression(paste(italic('C. tropicalis')," isotypes")))+
ggtitle("IV:4634192")
ctrop_bar
ggsave("../plots/ctrop9944_barplot3.png",dpi=300,height=4,width = 8, units = "in")
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#load brig geno
load('../processed_data/trop_geno.Rdata')
load('../processed_data/ct_len_isotype.Rdata')
#variants in notion
#variants : 5337683, 5337741
ctrop <- trop_geno %>% filter(POS==5337683) %>% filter(CHROM=="V")
trop_temp1 <- ctrop %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
iso_list <- trop_temp1 %>% filter(altref==-1) %>% dplyr::select(isotype) %>% distinct() %>% add_column(status=1)
ctrop_strains <- ct_len_isotype %>% mutate(isotype=fct_reorder(isotype,length))
x <- as_tibble(setdiff(ctrop_strains$isotype,iso_list$isotype))
y <- x %>% add_column(status=-1)
y <- y %>% dplyr::rename(isotype=value)
z <- full_join(iso_list,y)
k <- inner_join(ct_len_isotype,z)
k <- k %>% mutate(status=as.character(status)) %>% mutate(status=str_replace(status,"-1","alt")) %>% mutate(status=str_replace(status,"1","ref"))
ctrop_bar <- k %>% mutate(isotype=fct_reorder(isotype,length)) %>%
ggplot(aes(x=isotype,y=length,fill=as.factor(status))) +
labs(fill="isotype") +
geom_bar(stat='identity') +
theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +
xlab(expression(paste(italic('C. tropicalis')," isotypes")))+
ggtitle("V:5337683")
ctrop_bar
#ggsave("../plots/ctrop17276_barplot1.png",dpi=300,height=4,width = 8, units = "in")
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#load brig geno
load('../processed_data/trop_geno.Rdata')
load('../processed_data/ct_len_isotype.Rdata')
#variants in notion
#variants : 5337683, 5337741
ctrop <- trop_geno %>% filter(POS==5337683) %>% filter(CHROM=="V")
trop_temp1 <- ctrop %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
iso_list <- trop_temp1 %>% filter(altref==-1) %>% dplyr::select(isotype) %>% distinct() %>% add_column(status=1)
ctrop_strains <- ct_len_isotype %>% mutate(isotype=fct_reorder(isotype,length))
x <- as_tibble(setdiff(ctrop_strains$isotype,iso_list$isotype))
y <- x %>% add_column(status=-1)
y <- y %>% dplyr::rename(isotype=value)
z <- full_join(iso_list,y)
k <- inner_join(ct_len_isotype,z)
k <- k %>% mutate(status=as.character(status)) %>% mutate(status=str_replace(status,"-1","alt")) %>% mutate(status=str_replace(status,"1","ref"))
ctrop_bar <- k %>% mutate(isotype=fct_reorder(isotype,length)) %>%
ggplot(aes(x=isotype,y=length,fill=as.factor(status))) +
labs(fill="isotype") +
geom_bar(stat='identity') +
theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +
xlab(expression(paste(italic('C. tropicalis')," isotypes")))+
ggtitle("V:5337683")
ctrop_bar
ggsave("../plots/ctrop17276_barplot1.png",dpi=300,height=4,width = 8, units = "in")
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#load brig geno
load('../processed_data/trop_geno.Rdata')
load('../processed_data/ct_len_isotype.Rdata')
#variants in notion
#variants : 5337683, 5337741
ctrop <- trop_geno %>% filter(POS==5337741) %>% filter(CHROM=="V")
trop_temp1 <- ctrop %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
iso_list <- trop_temp1 %>% filter(altref==-1) %>% dplyr::select(isotype) %>% distinct() %>% add_column(status=1)
ctrop_strains <- ct_len_isotype %>% mutate(isotype=fct_reorder(isotype,length))
x <- as_tibble(setdiff(ctrop_strains$isotype,iso_list$isotype))
y <- x %>% add_column(status=-1)
y <- y %>% dplyr::rename(isotype=value)
z <- full_join(iso_list,y)
k <- inner_join(ct_len_isotype,z)
k <- k %>% mutate(status=as.character(status)) %>% mutate(status=str_replace(status,"-1","alt")) %>% mutate(status=str_replace(status,"1","ref"))
ctrop_bar <- k %>% mutate(isotype=fct_reorder(isotype,length)) %>%
ggplot(aes(x=isotype,y=length,fill=as.factor(status))) +
labs(fill="isotype") +
geom_bar(stat='identity') +
theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +
xlab(expression(paste(italic('C. tropicalis')," isotypes")))+
ggtitle("V:5337741")
ctrop_bar
ggsave("../plots/ctrop17276_barplot2.png",dpi=300,height=4,width = 8, units = "in")
#manhattan plots
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#load brig geno
load('../processed_data/brig_geno.Rdata')
load('../processed_data/cb_len_isotype.Rdata')
load('../processed_data/brig_fgeno.Rdata')
brig_geno
brig_geno %>% filter(CHROM=="I") %>% filter(POS>4334193) %>% filter(POS<4337371)
brig_geno %>% filter(CHROM=="II") %>% filter(POS>4334193) %>% filter(POS<4337371)
brig
cbraex5 <- brig_geno %>% filter(POS==4334473) %>% filter(CHROM=='II')
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
iso_list <- brig_temp1 %>% filter(altref==-1) %>% dplyr::select(isotype) %>% distinct() %>% add_column(status=1)
cbraex_strains <- cb_len_isotype %>% mutate(isotype=fct_reorder(isotype,length))
x <- as_tibble(setdiff(cbraex_strains$isotype,iso_list$isotype))
y <- x %>% add_column(status=-1)
y <- y %>% dplyr::rename(isotype=value)
z <- full_join(iso_list,y)
k <- inner_join(cb_len_isotype,z)
k <- k %>% mutate(status=as.character(status)) %>% mutate(status=str_replace(status,"-1","alt")) %>% mutate(status=str_replace(status,"1","ref"))
cbraex_bar <- k %>% mutate(isotype=fct_reorder(isotype,length)) %>%
ggplot(aes(x=isotype,y=length,fill=as.factor(status))) +
labs(fill="isotype") +
geom_bar(stat='identity') +
theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +
xlab(expression(paste(italic('C. briggsae')," isotypes")))+
ggtitle("I:4334473")
cbraex_bar
#ggsave("../plots/cbrqx14110_barplot_1.png",dpi=300,height=4,width = 8, units = "in")
brig
cbraex5 <- brig_geno %>% filter(POS==4334473) %>% filter(CHROM=='II')
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
iso_list <- brig_temp1 %>% filter(altref==-1) %>% dplyr::select(isotype) %>% distinct() %>% add_column(status=1)
cbraex_strains <- cb_len_isotype %>% mutate(isotype=fct_reorder(isotype,length))
x <- as_tibble(setdiff(cbraex_strains$isotype,iso_list$isotype))
y <- x %>% add_column(status=-1)
y <- y %>% dplyr::rename(isotype=value)
z <- full_join(iso_list,y)
k <- inner_join(cb_len_isotype,z)
k <- k %>% mutate(status=as.character(status)) %>% mutate(status=str_replace(status,"-1","alt")) %>% mutate(status=str_replace(status,"1","ref"))
cbraex_bar <- k %>% mutate(isotype=fct_reorder(isotype,length)) %>%
ggplot(aes(x=isotype,y=length,fill=as.factor(status))) +
labs(fill="isotype") +
geom_bar(stat='identity') +
theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +
xlab(expression(paste(italic('C. briggsae')," isotypes")))+
ggtitle("I:4334473")
cbraex_bar
ggsave("../plots/cbrqx14110_barplot_1.png",dpi=300,height=4,width = 8, units = "in")
brig
cbraex5 <- brig_geno %>% filter(POS==4336815) %>% filter(CHROM=='II')
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
iso_list <- brig_temp1 %>% filter(altref==-1) %>% dplyr::select(isotype) %>% distinct() %>% add_column(status=1)
cbraex_strains <- cb_len_isotype %>% mutate(isotype=fct_reorder(isotype,length))
x <- as_tibble(setdiff(cbraex_strains$isotype,iso_list$isotype))
y <- x %>% add_column(status=-1)
y <- y %>% dplyr::rename(isotype=value)
z <- full_join(iso_list,y)
k <- inner_join(cb_len_isotype,z)
k <- k %>% mutate(status=as.character(status)) %>% mutate(status=str_replace(status,"-1","alt")) %>% mutate(status=str_replace(status,"1","ref"))
cbraex_bar <- k %>% mutate(isotype=fct_reorder(isotype,length)) %>%
ggplot(aes(x=isotype,y=length,fill=as.factor(status))) +
labs(fill="isotype") +
geom_bar(stat='identity') +
theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +
xlab(expression(paste(italic('C. briggsae')," isotypes")))+
ggtitle("I:4336815")
cbraex_bar
ggsave("../plots/cbrqx14110_barplot_1.png",dpi=300,height=4,width = 8, units = "in")
brig
cbraex5 <- brig_geno %>% filter(POS==4336815) %>% filter(CHROM=='II')
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
iso_list <- brig_temp1 %>% filter(altref==-1) %>% dplyr::select(isotype) %>% distinct() %>% add_column(status=1)
cbraex_strains <- cb_len_isotype %>% mutate(isotype=fct_reorder(isotype,length))
x <- as_tibble(setdiff(cbraex_strains$isotype,iso_list$isotype))
y <- x %>% add_column(status=-1)
y <- y %>% dplyr::rename(isotype=value)
z <- full_join(iso_list,y)
k <- inner_join(cb_len_isotype,z)
k <- k %>% mutate(status=as.character(status)) %>% mutate(status=str_replace(status,"-1","alt")) %>% mutate(status=str_replace(status,"1","ref"))
cbraex_bar <- k %>% mutate(isotype=fct_reorder(isotype,length)) %>%
ggplot(aes(x=isotype,y=length,fill=as.factor(status))) +
labs(fill="isotype") +
geom_bar(stat='identity') +
theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +
xlab(expression(paste(italic('C. briggsae')," isotypes")))+
ggtitle("I:4336815")
cbraex_bar
ggsave("../plots/cbrqx14110_barplot_2.png",dpi=300,height=4,width = 8, units = "in")
brig
cbraex5 <- brig_geno %>% filter(POS==4334473) %>% filter(CHROM=='II')
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
iso_list <- brig_temp1 %>% filter(altref==-1) %>% dplyr::select(isotype) %>% distinct() %>% add_column(status=1)
cbraex_strains <- cb_len_isotype %>% mutate(isotype=fct_reorder(isotype,length))
x <- as_tibble(setdiff(cbraex_strains$isotype,iso_list$isotype))
y <- x %>% add_column(status=-1)
y <- y %>% dplyr::rename(isotype=value)
z <- full_join(iso_list,y)
k <- inner_join(cb_len_isotype,z)
k <- k %>% mutate(status=as.character(status)) %>% mutate(status=str_replace(status,"-1","alt")) %>% mutate(status=str_replace(status,"1","ref"))
cbraex_bar <- k %>% mutate(isotype=fct_reorder(isotype,length)) %>%
ggplot(aes(x=isotype,y=length,fill=as.factor(status))) +
labs(fill="isotype") +
geom_bar(stat='identity') +
theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +
xlab(expression(paste(italic('C. briggsae')," isotypes")))+
ggtitle("I:4334473")
cbraex_bar
ggsave("../plots/cbrqx14110_barplot_1.png",dpi=300,height=4,width = 8, units = "in")
#manhattan plots
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#load brig geno
load('../processed_data/brig_geno.Rdata')
load('../processed_data/cb_len_isotype.Rdata')
load('../processed_data/brig_fgeno.Rdata')
cbraex5 <- brig_geno %>% filter(POS==15446045) %>% filter(CHROM=='I')
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
iso_list <- brig_temp1 %>% filter(altref==-1) %>% dplyr::select(isotype) %>% distinct() %>% add_column(status=1)
cbraex_strains <- cb_len_isotype %>% mutate(isotype=fct_reorder(isotype,length))
x <- as_tibble(setdiff(cbraex_strains$isotype,iso_list$isotype))
y <- x %>% add_column(status=-1)
y <- y %>% dplyr::rename(isotype=value)
z <- full_join(iso_list,y)
k <- inner_join(cb_len_isotype,z)
k <- k %>% mutate(status=as.character(status)) %>% mutate(status=str_replace(status,"-1","alt")) %>% mutate(status=str_replace(status,"1","ref"))
cbraex_bar <- k %>% mutate(isotype=fct_reorder(isotype,length)) %>%
ggplot(aes(x=isotype,y=length,fill=as.factor(status))) +
labs(fill="isotype") +
geom_bar(stat='identity') +
theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +
xlab(expression(paste(italic('C. briggsae')," isotypes")))+
ggtitle("I:15446045")
cbraex_bar
ggsave("../plots/cbrqx9296_barplot_1.png",dpi=300,height=4,width = 8, units = "in")
#manhattan plots
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#
load("../functions/gene_model.Rdata")
load("../processed_data/goi_list.Rdata")
goi_list <- goi_list %>% add_row(
gene='qx9184',
chr='I',
strand='+',
txstart=14797708,
txend=14806589,
codingstart=txstart,
codingend=txend,
numexons=12,
wbgene='Wb000',
gene_name=gene,
biotype='protein_coding',
exonstarts='14797708,14797896,14798398,14800092,14800739,14802352,14803481,14804101,14804449,14805953,14806242,14806439',
exonends='14797849,14798009,14799392,14800233,14801491,14802598,14803767,14804273,14804712,14806195,14806393,14806589',
type='transcript'
)
cbrqx9184_model <- gene_model(goi_list,'qx9184')
cbrqx9184_model
save(cbrqx9184_model,file="../processed_data/cbrqx9184_model.Rdata")
#manhattan plots
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#load brig geno
load('../processed_data/brig_geno.Rdata')
load('../processed_data/brig_fgeno.Rdata')
load('../processed_data/cb_len_isotype.Rdata')
load('../processed_data/brig_pop_boxplot.Rdata')
load('../processed_data/cbrqx9184_model.Rdata')
#cbraex5 <- brig_geno %>% dplyr::filter(POS>14761948 & POS<14772711) %>% dplyr::filter(CHROM=="I")
cbraex5 <- brig_fgeno %>% filter(POS==14804441 | POS==14798602 | POS==14800045) %>% filter(CHROM==1)
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
brig_temp <- brig_temp1 %>% inner_join(cb_len_isotype) %>% filter(altref==1) %>% dplyr::select(POS,length,isotype)
cbraex5_plot <- brig_temp %>% ggplot(aes(x=POS,y=length,group=POS)) +
geom_boxplot() +
#scale_x_continuous(breaks=c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),lim=c(14669282,14679748))+
scale_x_continuous(lim=c(14797708,14806589))+
#geom_jitter(color="black", alpha=0.1) +
#theme(axis.title = element_blank(), legend.position = "none",axis.text.x = element_text(angle = 60, vjust = 1, hjust = 1))+
theme(axis.title = element_blank(), legend.position = "none")+
ylim(0,15)
#geom_hline(yintercept=3.68,color='blue')
#geom_vline(xintercept = c(14669282,14679748,14669282,14671667,14676069,14676749,14677416,14677725,14679067,14679211,14670011,14671846,14676265,14676905,14677619,14677823,14679164,14679748),linetype="dashed",alpha=0.5)
#geom_vline(xintercept = c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),linetype="dashed",alpha=0.5)
cbraex5_plot
p <- plot_grid(cbrqx9184_model,cbraex5_plot,ncol=1, align='v',rel_widths=c(1,1),rel_heights = c(1,12))
x <- plot_grid(NULL,brig_pop_plot,ncol=1,align='v',rel_widths=c(1,1),rel_heights = c(1,12))
#ggsave("../plots/cbraex5_boxplot.png",dpi=300,height=4,width = 8, units = "in")
#ggsave("../plots/cbraex5_boxplot_high_impact.png",dpi=300,height=4,width = 8, units = "in")
q <- plot_grid(p,x,rel_widths = c(3,1))
q
ggsave("../plots/cbrqx9184_boxplot_highimpact.png",dpi=300,height=4,width = 12, units = "in")
#manhattan plots
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
load('../processed_data/cb_len_isotype.Rdata')
brig_pop_plot <- cb_len_isotype %>% ggplot(aes(x="",y=length)) +
geom_boxplot() +
ylim(0,15) +
theme_bw() +
theme(axis.title = element_blank(), legend.position = "none",axis.text.y = element_blank(),axis.ticks.y = element_blank())
brig_pop_plot
save(brig_pop_plot,file="../processed_data/brig_pop_boxplot.Rdata")
#manhattan plots
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#load brig geno
load('../processed_data/brig_geno.Rdata')
load('../processed_data/brig_fgeno.Rdata')
load('../processed_data/cb_len_isotype.Rdata')
load('../processed_data/brig_pop_boxplot.Rdata')
load('../processed_data/cbrqx9184_model.Rdata')
#cbraex5 <- brig_geno %>% dplyr::filter(POS>14761948 & POS<14772711) %>% dplyr::filter(CHROM=="I")
cbraex5 <- brig_fgeno %>% filter(POS==14804441 | POS==14798602 | POS==14800045) %>% filter(CHROM==1)
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
brig_temp <- brig_temp1 %>% inner_join(cb_len_isotype) %>% filter(altref==1) %>% dplyr::select(POS,length,isotype)
cbraex5_plot <- brig_temp %>% ggplot(aes(x=POS,y=length,group=POS)) +
geom_boxplot() +
#scale_x_continuous(breaks=c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),lim=c(14669282,14679748))+
scale_x_continuous(lim=c(14797708,14806589))+
#geom_jitter(color="black", alpha=0.1) +
#theme(axis.title = element_blank(), legend.position = "none",axis.text.x = element_text(angle = 60, vjust = 1, hjust = 1))+
theme(axis.title = element_blank(), legend.position = "none")+
ylim(0,15)
#geom_hline(yintercept=3.68,color='blue')
#geom_vline(xintercept = c(14669282,14679748,14669282,14671667,14676069,14676749,14677416,14677725,14679067,14679211,14670011,14671846,14676265,14676905,14677619,14677823,14679164,14679748),linetype="dashed",alpha=0.5)
#geom_vline(xintercept = c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),linetype="dashed",alpha=0.5)
cbraex5_plot
p <- plot_grid(cbrqx9184_model,cbraex5_plot,ncol=1, align='v',rel_widths=c(1,1),rel_heights = c(1,12))
x <- plot_grid(NULL,brig_pop_plot,ncol=1,align='v',rel_widths=c(1,1),rel_heights = c(1,12))
#ggsave("../plots/cbraex5_boxplot.png",dpi=300,height=4,width = 8, units = "in")
#ggsave("../plots/cbraex5_boxplot_high_impact.png",dpi=300,height=4,width = 8, units = "in")
q <- plot_grid(p,x,rel_widths = c(3,1))
q
ggsave("../plots/cbrqx9184_boxplot_highimpact.png",dpi=300,height=4,width = 12, units = "in")
#manhattan plots
library("tidyverse")
library("plotly")
library("DT")
library("ggbeeswarm")
library("knitr")
library("ggrepel")
library("genetics")
library("ggnewscale")
library("cowplot")
#load brig geno
load('../processed_data/brig_geno.Rdata')
load('../processed_data/brig_fgeno.Rdata')
load('../processed_data/cb_len_isotype.Rdata')
load('../processed_data/brig_pop_boxplot.Rdata')
load('../processed_data/cbrqx9184_model.Rdata')
#cbraex5 <- brig_geno %>% dplyr::filter(POS>14761948 & POS<14772711) %>% dplyr::filter(CHROM=="I")
cbraex5 <- brig_fgeno %>% filter(POS==14804441 | POS==14798602 | POS==14800045) %>% filter(CHROM==1)
brig_temp1 <- cbraex5 %>% pivot_longer(
cols=!CHROM & !POS & !REF & !ALT,
names_to = "isotype",
values_to = "altref"
)
brig_temp <- brig_temp1 %>% inner_join(cb_len_isotype) %>% filter(altref==1) %>% dplyr::select(POS,length,isotype)
cbraex5_plot <- brig_temp %>% ggplot(aes(x=POS,y=length,group=POS)) +
geom_boxplot() +
theme_bw() +
#scale_x_continuous(breaks=c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),lim=c(14669282,14679748))+
scale_x_continuous(lim=c(14797708,14806589))+
#geom_jitter(color="black", alpha=0.1) +
#theme(axis.title = element_blank(), legend.position = "none",axis.text.x = element_text(angle = 60, vjust = 1, hjust = 1))+
theme(axis.title = element_blank(), legend.position = "none")+
ylim(0,15)
#geom_hline(yintercept=3.68,color='blue')
#geom_vline(xintercept = c(14669282,14679748,14669282,14671667,14676069,14676749,14677416,14677725,14679067,14679211,14670011,14671846,14676265,14676905,14677619,14677823,14679164,14679748),linetype="dashed",alpha=0.5)
#geom_vline(xintercept = c(14670406,14672327,14673372,14673503,14673745,14674803,14676169),linetype="dashed",alpha=0.5)
cbraex5_plot
p <- plot_grid(cbrqx9184_model,cbraex5_plot,ncol=1, align='v',rel_widths=c(1,1),rel_heights = c(1,12))
x <- plot_grid(NULL,brig_pop_plot,ncol=1,align='v',rel_widths=c(1,1),rel_heights = c(1,12))
#ggsave("../plots/cbraex5_boxplot.png",dpi=300,height=4,width = 8, units = "in")
#ggsave("../plots/cbraex5_boxplot_high_impact.png",dpi=300,height=4,width = 8, units = "in")
q <- plot_grid(p,x,rel_widths = c(3,1))
q
ggsave("../plots/cbrqx9184_boxplot_highimpact.png",dpi=300,height=4,width = 12, units = "in")
